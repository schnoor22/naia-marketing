var M=Object.defineProperty;var R=(a,e,t)=>e in a?M(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var y=(a,e,t)=>(R(a,typeof e!="symbol"?e+"":e,t),t),E=(a,e,t)=>{if(!e.has(a))throw TypeError("Cannot "+t)};var s=(a,e,t)=>(E(a,e,"read from private field"),t?t.call(a):e.get(a)),u=(a,e,t)=>{if(e.has(a))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(a):e.set(a,t)},A=(a,e,t,i)=>(E(a,e,"write to private field"),i?i.call(a,t):e.set(a,t),t);import{aD as S,a6 as k,_ as x,$ as T,Y as w,h as g,V as B,aB as F,a4 as N,aE as C,b as Y,a as H,E as I,aF as L,X as O,a9 as P,a7 as V,al as D}from"./runtime.1363a653.js";var d,l,c,_,v,b,m;class X{constructor(e,t=!0){y(this,"anchor");u(this,d,new Map);u(this,l,new Map);u(this,c,new Map);u(this,_,new Set);u(this,v,!0);u(this,b,()=>{var e=F;if(s(this,d).has(e)){var t=s(this,d).get(e),i=s(this,l).get(t);if(i)S(i),s(this,_).delete(t);else{var n=s(this,c).get(t);n&&(s(this,l).set(t,n.effect),s(this,c).delete(t),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),i=n.effect)}for(const[f,r]of s(this,d)){if(s(this,d).delete(f),f===e)break;const h=s(this,c).get(r);h&&(k(h.effect),s(this,c).delete(r))}for(const[f,r]of s(this,l)){if(f===t||s(this,_).has(f))continue;const h=()=>{if(Array.from(s(this,d).values()).includes(f)){var p=document.createDocumentFragment();N(r,p),p.append(T()),s(this,c).set(f,{effect:r,fragment:p})}else k(r);s(this,_).delete(f),s(this,l).delete(f)};s(this,v)||!i?(s(this,_).add(f),x(r,h,!1)):h()}}});u(this,m,e=>{s(this,d).delete(e);const t=Array.from(s(this,d).values());for(const[i,n]of s(this,c))t.includes(i)||(k(n.effect),s(this,c).delete(i))});this.anchor=e,A(this,v,t)}ensure(e,t){var i=F,n=C();if(t&&!s(this,l).has(e)&&!s(this,c).has(e))if(n){var f=document.createDocumentFragment(),r=T();f.append(r),s(this,c).set(e,{effect:w(()=>t(r)),fragment:f})}else s(this,l).set(e,w(()=>t(this.anchor)));if(s(this,d).set(i,e),n){for(const[h,o]of s(this,l))h===e?i.skipped_effects.delete(o):i.skipped_effects.add(o);for(const[h,o]of s(this,c))h===e?i.skipped_effects.delete(o.effect):i.skipped_effects.add(o.effect);i.oncommit(s(this,b)),i.ondiscard(s(this,m))}else g&&(this.anchor=B),s(this,b).call(this)}}d=new WeakMap,l=new WeakMap,c=new WeakMap,_=new WeakMap,v=new WeakMap,b=new WeakMap,m=new WeakMap;function q(a,e,t=!1){g&&H();var i=new X(a),n=t?I:0;function f(r,h){if(g){const p=L(a)===O;if(r===p){var o=P();V(o),i.anchor=o,D(!1),i.ensure(r,h),D(!0);return}}i.ensure(r,h)}Y(()=>{var r=!1;e((h,o=!0)=>{r=!0,f(o,h)}),r||f(!1,null)},n)}export{X as B,q as i};
